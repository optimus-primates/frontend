<!DOCTYPE html>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<html>
	<head>
	<title>GOTHENBURG STARTUP ARENA</title>		
	<link href ="main.css" rel ="stylesheet"></link>
	<script type="text/javascript"
		src="https://maps.googleapis.com/maps/api/js?libraries=visualization,places">
	</script>
	<script type="text/javascript">	
	var map;
	var service;
	var PLACES_LIMIT = 10;	
	var requestedTag;
	var heatmap;
	var newGradient;
	var taxiData = new Array();
	

		/* Useful functions */
		/* ON-OFF the heatmap */ 
		function toggleHeatmap() {
			heatmap.setMap(heatmap.getMap() ? null : map);
		}
		
		function changeRadius() {
			heatmap.set('radius', heatmap.get('radius') ? null : 100);
		}
		
		function changeOpacity(opValue) {
		heatmap.set('opacity', heatmap.get('opacity') ? null : opValue);
		}
		
		function changeGradientRestaurant(){
		
		newGradient = ['rgba(0, 255, 255, 0)','red', 'yellow']
		
		}
		
		function changeGradientFashion(){
		
		newGradient = ['rgba(0, 255, 255, 0)','lime', 'green']
		
		}
		
		function changeGradientBook(){
		
		newGradient = ['rgba(0, 255, 255, 0)','black', 'silver']
		
		}
		
		function changeGradientTech(){
		
		newGradient = ['rgba(0, 255, 255, 0)','blue', 'aqua']
		
		}



	
		function handleSearchResults(results,status){
		
		console.log(results);
		
		var positionScreenOne = new google.maps.LatLng(57.707065, 11.968627);
		var positionScreenTwo = new google.maps.LatLng(57.708545, 11.973627);
		
			if (status == google.maps.places.PlacesServiceStatus.OK) {
//				for (var i = 0; i < results.length; i++) {
//					var marker = new google.maps.Marker({
//					position: results[i].geometry.location, 
//					map:map
//					});
//				}
				taxiData = [];
				for (var i = 0; i < results.length; i++) {
					
					taxiData.push(new google.maps.LatLng (results[i].geometry.location.A, results[i].geometry.location.F));
				}
		
			}
			
			var markerScreen1 = new google.maps.Marker({
							title: "SCREEN 1",
							position: positionScreenOne,
							icon: "http://maps.google.com/mapfiles/ms/icons/green-dot.png",
							snippet: "10000 people interested",
							map:map
							});
							
			var markerScreen2 = new google.maps.Marker({	
							title: "SCREEN 2",
							position: positionScreenTwo,
							icon: "http://maps.google.com/mapfiles/ms/icons/green-dot.png",							
							map:map
							});
							
	var pointArray = new google.maps.MVCArray(taxiData);

	heatmap = new google.maps.visualization.HeatmapLayer({
    data: pointArray,
	radius : 40
	});
	
	var opValue = 0.2;
	heatmap.set('gradient', heatmap.get('gradient') ? null : newGradient);
	heatmap.setMap(map);
	
	//changeGradientFashion();
	//changeGradientRestaurant();
	//changeGradientBook();
	//changeGradientTech();
	//changeRadius();


	}
	
		function performSearch () {
		
			
		service.radarSearch(requestedTag, handleSearchResults);
		//service.radarSearch(requestTech, handleSearchResults);
		//service.radarSearch(requestClothes, handleSearchResults);
		//service.radarSearch(requestBook, handleSearchResults);
		
		
		}
	
		function initialize () {	
		
			
			
			var mapOptions = {
				center: new google.maps.LatLng(57.708037,11.9683625),
				zoom: 16,
				mapTypeId: google.maps.MapTypeId.ROADMAP
			}
			map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

	service = new google.maps.places.PlacesService(map);
	//wait for bounds to exist and then performSearch (cannot do with listener otherwise I'll call this for every zoom in/out)
	google.maps.event.addListenerOnce(map, 'bounds_changed', performSearch);
	
	
	}
	
	function refreshPage () {	
	
		var requestRestaurant = {
		bounds: map.getBounds(),
		types: ['restaurant']};

	var requestTech = {
		bounds: map.getBounds(),
		types: ['electronics_store']};

	var requestClothes = {
		bounds: map.getBounds(),
		types: ['clothing_store']};

	var requestBook = {
		bounds: map.getBounds(),
		types: ['book_store']};

			
		if (document.getElementById('food').checked){
			requestedTag=requestRestaurant;
			changeGradientRestaurant();
			}
		else if (document.getElementById('electronics').checked) {
			requestedTag=requestTech;
			changeGradientTech();
			}
		else if (document.getElementById('clothes').checked){
			changeGradientFashion();
			requestedTag=requestClothes;
			}
		else if (document.getElementById('books').checked){
			changeGradientBook();
			requestedTag=requestBook;
		}
		initialize();
	}
	
	</script>
</head>

<body onload="initialize()">

<div class="header-wrap">
		<header>
			<nav class="main-nav">
    			<ul>
        			<li><a id="group_name" href="#">OPTIMUS PRIMATES</a></li>
        			<li><a id="about_us" href="#">ABOUT US</a></li>
        		</ul>
    		</nav>
		</header>
</div>

<div id = "container">

	<div id = "map-canvas"></div>
	<div id = "sliders-canvas">	

	<br></br>
	<br></br>
	<br></br>
		<div id = sliders>
			<p align ="center"> Hour of the day </p>	
			
			<img src="00.png" height="15" width="15" />
			<img src="24.png" height="15" width="15" style = "float :right" />
			
			<div class ="slider"align = "center">			
				
				<form ><input type="range" id = "HourSlider" min="00" max="24" step="1" ></form>
				
			</div>
			
			<br></br>
			<!--<p align ="center"> Weather </p>	
			
			<img src="sun.png" height="42" width="42" />
			<img src="rain.png" height="42" width="42" style = "float :right" />
			
			<div class ="slider"align = "center">
				
				<form ><input type="range" id = "WeatherSlider" min="1" max="2" step="1" ></form>
				
			</div>
			<br></br>-->
			
			
			<div class = "radio-wrapper" align="center">
			<input type="radio" id="clothes" name="value"/>
			<label for="clothes"><img src="clothes.png" height="80" width="80" /></label>
			
			<input type="radio" id="food" name="value"/>
			<label for="food"><img src="food.png" height="80" width="80" /></label>
			
			<br></br>
			
			<input type="radio" id="electronics" name="value"/>
			<label for="electronics"><img src="electronics.png" height="80" width="80" /></label>
			
			<input type="radio" id="books" name="value"/>
			<label for="books"><img src="books.png" height="80" width="80" /></label>
			
			<br></br>
			<button type="button" onclick="refreshPage()" id="submit">Refresh</button>
			</div>
		</div>
	</div>
	

</div>
<div class ="footer-wrap">
<footer> <span style ="color:#FFF"> GOTHENBURG STARTUP HACK </span></footer>
</div>
	

</body>
</html> 